# 要件定義書

## 1. 機能要件

### 1.1 共通機能
*   **ログイン/ログアウト**: ユーザーIDとパスワードによる認証。
*   **ダッシュボード**: ログインユーザーに応じた情報の表示（カレンダー形式のシフト表など）。

### 1.2 オーナー（管理者）機能
#### 1.2.1 従業員管理
*   **従業員一覧表示**: 登録されている従業員のID、名前、時給、交通費を表示。
*   **従業員登録・編集**:
    *   基本情報（ユーザー名、パスワード）の登録・変更。
    *   雇用条件（基本時給、1日あたりの交通費）の設定。
    *   パスワードリセット機能。

#### 1.2.2 シフト管理
*   **希望シフト一覧**: 従業員から提出されたシフト希望の確認。
*   **シフト作成・編集**: 日付・時間指定によるシフトの登録・修正・削除。
*   **月間シフト表示**: カレンダー形式での全従業員のシフト確認。

#### 1.2.3 給与管理
*   **月間給与集計**:
    *   指定月（締め日に基づく期間）の全従業員の勤務時間・給与を集計表示。
    *   **深夜割増計算**: 22:00〜翌05:00 の勤務時間を自動判定し、時給を1.25倍で計算。
    *   **交通費計算**: 出勤日数 × 設定された交通費を加算。
    *   **締め日処理**: 設定された締め日（例: 15日）に基づいて集計期間を自動算出（例: 前月16日〜当月15日）。
*   **明細確認**: 各従業員の給与明細プレビュー機能。

### 1.3 パートタイム（従業員）機能
#### 1.3.1 シフト関連
*   **シフト希望提出**: 日付、開始時間、終了時間を指定して希望を送信。
*   **確定シフト確認**: 自分のシフトスケジュールを一覧・カレンダーで確認。

#### 1.3.2 給与明細
*   **電子交付同意**: 給与明細の電子交付に対する同意/不同意の登録（初回必須）。
*   **明細一覧**: 過去の給与明細（月別）の一覧表示。
*   **明細閲覧・印刷**:
    *   詳細な給与明細書（支給項目、勤怠項目）のWeb表示。
    *   A4サイズでの印刷に最適化されたレイアウト。

## 2. 非機能要件

### 2.1 ユーザビリティ（UI/UX）
*   **デザイン**: インディゴ・スレートを基調としたモダンで清潔感のあるデザイン。
*   **フォント**: 視認性の高い Google Fonts (Inter, Noto Sans JP) を使用。
*   **レスポンシブ**: PC、タブレット、スマートフォンでの閲覧・操作に対応。

### 2.2 セキュリティ
*   **認証**: パスワードはハッシュ化（`password_hash`）してデータベースに保存。
*   **アクセス制御**: ユーザー種別（owner/part-time）による厳格なページアクセス制限。
*   **入力対策**: `htmlspecialchars` によるXSS対策、プリペアドステートメントによるSQLインジェクション対策。

### 2.3 データ要件
*   **データベース**: MySQL (MariaDB) を使用。
*   **設定管理**: 締め日、支払日などのシステム設定はデータベース（`system_settings` テーブル）で管理。

## 3. システム環境
*   **サーバーサイド**: PHP 7.4以上
*   **データベース**: MySQL / MariaDB
*   **クライアント**: モダンブラウザ（Chrome, Edge, Safari, Firefox）
